<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>batch_effects_vector_inspection — batch_effects_vector_inspection • dmatch</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="batch_effects_vector_inspection — batch_effects_vector_inspection" />
<meta property="og:description" content="Function for calculating batch effects vectors and their angles, which can aid determining the right amount of PCs to correct for batch effects.
Batch effects vectors should be understood in the following way. When we correct batch effects for a pair of samples in 2-D PC space (PC1 and 2, PC3 and 4, ...), assume there are four shared clusters (1,2,3,4) in each of those two samples. We can draw a line (with direction) connecting the center of cluster 1 in the reference sample and the center of cluster 1 in the to-be-corrected sample. Direction of the line can be understood in the following way: positive means that the center of cluster 1 in the to-be-corrected reference sample is to the right of the center of cluster 1 in the reference sample; negative means the other way. Such lines are batch effects vectors. 
This function calculates the angles between those batch effects vectors. If the angles are small, for example, if the angle between batch effect vector for cluster 1 and that for cluster 2 is small, it means that the adjustments/correction for cluster 1 and cluster 2 are fairly similar. On the other hand, if the angle between batch effect vector for cluster 1 and that for cluster 2 is big, for example, almost 180 degrees, then whatever the adjustment/correction required for cluster 1 will be opposite to whatever adjustment/correction required for cluster 2. So the corrections required for different clusters are quite different.
Often, the default number of PCs (top 30 PCs) works well for batch effects correction. However, we can use this function to make sure that whether the angles between different batch effects vectors are overall acceptable (small or moderate sizes). Sometimes the batch effects are consistent only for top 6 PCs for example. Then we will correct batch effects on top 6 PCs." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">dmatch</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.8</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Functions</a>
</li>
<li>
  <a href="../articles/dmatch.html">Tutorial</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/qzhan321/dmatch">
    <span class="fa fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>batch_effects_vector_inspection</h1>
    <small class="dont-index">Source: <a href='https://github.com/qzhan321/dmatch/blob/master/R/batch_effects_vector_inspection.R'><code>R/batch_effects_vector_inspection.R</code></a></small>
    <div class="hidden name"><code>batch_effects_vector_inspection.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Function for calculating batch effects vectors and their angles, which can aid determining the right amount of PCs to correct for batch effects.
Batch effects vectors should be understood in the following way. When we correct batch effects for a pair of samples in 2-D PC space (PC1 and 2, PC3 and 4, ...), assume there are four shared clusters (1,2,3,4) in each of those two samples. We can draw a line (with direction) connecting the center of cluster 1 in the reference sample and the center of cluster 1 in the to-be-corrected sample. Direction of the line can be understood in the following way: positive means that the center of cluster 1 in the to-be-corrected reference sample is to the right of the center of cluster 1 in the reference sample; negative means the other way. Such lines are batch effects vectors. 
This function calculates the angles between those batch effects vectors. If the angles are small, for example, if the angle between batch effect vector for cluster 1 and that for cluster 2 is small, it means that the adjustments/correction for cluster 1 and cluster 2 are fairly similar. On the other hand, if the angle between batch effect vector for cluster 1 and that for cluster 2 is big, for example, almost 180 degrees, then whatever the adjustment/correction required for cluster 1 will be opposite to whatever adjustment/correction required for cluster 2. So the corrections required for different clusters are quite different.
Often, the default number of PCs (top 30 PCs) works well for batch effects correction. However, we can use this function to make sure that whether the angles between different batch effects vectors are overall acceptable (small or moderate sizes). Sometimes the batch effects are consistent only for top 6 PCs for example. Then we will correct batch effects on top 6 PCs.</p>
    </div>

    <pre class="usage"><span class='fu'>batch_effects_vector_inspection</span>(
  <span class='no'>object</span>,
  <span class='kw'>quantile</span> <span class='kw'>=</span> <span class='fl'>0.95</span>,
  <span class='no'>PCs_to_check</span>,
  <span class='no'>clusters_to_check</span>
)</pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>object</th>
      <td><p>A dmatch class object</p></td>
    </tr>
    <tr>
      <th>quantile</th>
      <td><p>The minimum number of the data points regarded as good points</p></td>
    </tr>
    <tr>
      <th>PCs_to_check</th>
      <td><p>Which PCs to check, for example, if set to be 1:10, this function will check the batch effects angles in every 2D PC space (PC1 and 2, PC3 and 4, ..., PC9 and 10)</p></td>
    </tr>
    <tr>
      <th>clusters_to_check</th>
      <td><p>Check the angles between which clusters, more specifically, the candidate clusters for anchors. For example, if set to be list(c(1,2),c(2,3)), this function will check the angles between batch effects for cluster 1 and 2, and those for cluster 2 and 3, in the specified PC space</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A dmatch class object which have slots storing raw.data, batch.id, PCA, and more information. Specifically, batch_effects_vector_angles slot stores information for the angles between batch effects vectors for different anchor cluster</p>

  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Mengjie Chen.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


